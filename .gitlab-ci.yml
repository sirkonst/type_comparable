stages:
  - test
  - release


test_3.3:
  stage: test
  image: python:3.3
  before_script:
    - pip install tox
  script:
    - make test PYTHON=3.3
  coverage: /\d+\%\s*$/

test_3.4:
  stage: test
  image: python:3.4
  before_script:
    - pip install tox
  script:
    - make test PYTHON=3.4
  coverage: /\d+\%\s*$/

test_3.5:
  stage: test
  image: python:3.5
  before_script:
    - pip install tox
  script:
    - make test PYTHON=3.5
  coverage: /\d+\%\s*$/

test_3.6:
  stage: test
  image: python:3.6
  before_script:
    - pip install tox
  script:
    - make test PYTHON=3.6
  coverage: /\d+\%\s*$/


upload_to_pypi:
  stage: release
  image: python
  before_script:
    - pip install setuptools wheel twine -U
  script:
    - make build_dist
    - make upload
  when: manual
  only:
    - master
    - develop
  environment:
    name: PyPi
    url: https://pypi.python.org/pypi/type_comparable
